:root{
  --nav-bg: rgba(255,255,255,0.08);
  --nav-border: rgba(255,255,255,0.18);
  --nav-text: #e9edf6;
  --nav-muted:#a6afbd;
  --brand:#7c5cff;
  --brand-2:#18e1c7;
  --ring: 0 0 0 4px rgba(124,92,255,.25);
  --radius:14px;
  --shadow: 0 10px 40px rgba(0,0,0,.35);
}

/* Container */
.smart-nav{
  position: sticky; top: 0.6rem; z-index: 50;
  display: grid; grid-template-columns: auto 1fr auto; gap: .75rem; align-items: center;
  padding: .6rem .8rem;
  border: 1px solid var(--nav-border); border-radius: var(--radius);
  backdrop-filter: blur(10px) saturate(160%);
  background: linear-gradient(180deg, var(--nav-bg), transparent);
  box-shadow: var(--shadow);
}

/* Brand */
.brand{display:flex;align-items:center;gap:.6rem;text-decoration:none;color:var(--nav-text);font-weight:800}
.brand__logo{
  display:grid;place-items:center;width:28px;height:28px;border-radius:10px;
  background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;font-size:.9rem
}
.brand__name{letter-spacing:.3px}

/* Burger */
.nav-toggle{
  display:none; align-items:center; gap:6px; padding:.5rem .6rem;
  border:1px solid var(--nav-border); background:transparent; border-radius:10px; cursor:pointer; color:var(--nav-text);
}
.nav-toggle .bar{display:block;width:18px;height:2px;background:currentColor}
.nav-toggle:focus{outline:none; box-shadow:var(--ring)}
.sr{position:absolute;left:-9999px}

/* Menu base */
.menu{list-style:none;margin:0;padding:0;display:flex;gap:.3rem;align-items:center}
.menu > li {position:relative}
.has-dropdown { position: relative; }              /* ensure submenu anchors to its li */

.menu a, .menu .dropdown-toggle{
  display:inline-flex;align-items:center;gap:.45rem;
  padding:.5rem .65rem;border-radius:10px;border:1px solid transparent;
  color:black; text-decoration:none; background:transparent; cursor:pointer;
  font: inherit;
}
.menu a:hover, .menu .dropdown-toggle:hover{background:rgba(255,255,255,0.12)}
.menu .dropdown-toggle:focus{outline:none; box-shadow:var(--ring)}
.caret{opacity:.75}

/* Dropdown */
.has-dropdown > .dropdown{
  position:absolute; top: calc(100% + 8px); left: 0; min-width: 220px; z-index: 30;
  list-style:none;margin:0;padding:.4rem;
  background: rgb(255, 255, 255);
  border:1px solid var(--nav-border); border-radius:12px; box-shadow: var(--shadow);
  transform: translateY(6px) scale(.98); opacity: 0; visibility: hidden;
  transition: transform .15s ease, opacity .15s ease, visibility .15s;
}
.dropdown > li { position: relative; }            /* anchor nested flyouts to each row */

.has-dropdown.drop-right > .dropdown{
  left: calc(100% + 8px);
  top: 0;                                         /* open aligned with hovered row */
}

.dropdown li a, .dropdown .dropdown-toggle{
  width:100%; justify-content:space-between; border-radius:8px; padding:.5rem .6rem
}
.dropdown li a:hover, .dropdown .dropdown-toggle:hover{ background: rgba(255,255,255,.08) }

/* Hover/focus to open (no clicks required on desktop) */
.has-dropdown:hover > .dropdown,
.has-dropdown:focus-within > .dropdown{
  transform: translateY(0) scale(1); opacity:1; visibility:visible;
}

/* Active link underline */
.menu > li > a{position:relative}
.menu > li > a::after{
  content:""; position:absolute; left:10%; right:10%; bottom:6px; height:2px;
  background: linear-gradient(90deg, var(--brand), var(--brand-2));
  transform: scaleX(0); transform-origin: left; transition: transform .18s ease;
}
.menu > li > a:hover::after{ transform: scaleX(1) }

/* Icons (Font Awesome v6 assumed) */
.menu i{opacity:.9}

/* Mobile */
@media (max-width: 900px){
  .nav-toggle{display:flex}
  .smart-nav{grid-template-columns:auto auto 1fr}
  .menu{
    position: fixed; left: 1rem; right: 1rem; top: 64px;
    display:none; flex-direction: column; align-items:stretch; gap:.2rem;
    padding:.6rem; background: rgba(15,20,34,.98);
    border:1px solid var(--nav-border); border-radius:12px; box-shadow: var(--shadow)
  }
  .menu.is-open{display:flex}

  /* on mobile, submenus render inline (always visible), easy to tap */
  .has-dropdown > .dropdown{
    position: static; transform:none; opacity:1; visibility:visible;
    background: transparent; border:0; box-shadow:none; padding:0; margin-left:.6rem;
  }
  .has-dropdown .dropdown .dropdown{ margin-left:.8rem }
}

/* Light-mode tweak baseline */
html[data-theme="light"] .smart-nav{
  background: linear-gradient(180deg, rgba(0,0,0,.04), rgba(0,0,0,.02));
  border-color: rgba(0,0,0,.08)
}

/* === High-contrast light-mode overrides (black on white bar, white dropdowns) === */
html[data-theme="light"] .smart-nav {
  background: #fff;
  border-color: #e5e7eb;
}

/* Top-level text/buttons/icons -> black */
html[data-theme="light"] .smart-nav .brand,
html[data-theme="light"] .smart-nav .brand *,
html[data-theme="light"] .smart-nav .menu > li > a,
html[data-theme="light"] .smart-nav .menu > li > .dropdown-toggle,
html[data-theme="light"] .smart-nav .nav-toggle {
  color: #000;
}

/* Carets -> black */
html[data-theme="light"] .smart-nav .caret { color: #000; opacity: 1; }

/* Hover states on the top bar */
html[data-theme="light"] .smart-nav .menu > li > a:hover,
html[data-theme="light"] .smart-nav .menu > li > .dropdown-toggle:hover {
  background: #f3f4f6;
}

/* Desktop dropdown panels -> white with black text */
html[data-theme="light"] .smart-nav .has-dropdown > .dropdown {
  background: #fff;
  border-color: #e5e7eb;
}
html[data-theme="light"] .smart-nav .has-dropdown > .dropdown a,
html[data-theme="light"] .smart-nav .has-dropdown > .dropdown .dropdown-toggle {
  color: #000;
}
html[data-theme="light"] .smart-nav .has-dropdown > .dropdown a:hover,
html[data-theme="light"] .smart-nav .has-dropdown > .dropdown .dropdown-toggle:hover {
  background: #f3f4f6;
}

/* Mobile drawer also white with black text */
@media (max-width: 900px) {
  html[data-theme="light"] .smart-nav .menu {
    background: #fff;
    border-color: #e5e7eb;
  }
  html[data-theme="light"] .smart-nav .menu a,
  html[data-theme="light"] .smart-nav .menu .dropdown-toggle {
    color: #000;
  }
}

/* Ensure icons adopt text color */
html[data-theme="light"] .smart-nav .menu i { color: inherit; opacity: 1; }
